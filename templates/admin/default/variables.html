{check_auth context="admin" roles="ADMIN" permissions="admin.configuration.variables.view" login_tpl="/admin/login"}

{$page_title={intl l='Configuration'}}

{include file='includes/header.inc.html'}

<div class="variables">

    <div id="wrapper" class="container">

        {module_include location='config_top'}

        <h2>{intl l="Thelia system variables configuration"}</h2>

        <div class="row-fluid">

            <div class="span6">
                <form>
	                <div class="general-block-decorator">
	                    <table class="table table-striped table-condensed table-left-aligned">
	                        <caption>
	                           {intl l='Thelia system variables'}
	                           {loop type="auth" name="can_create" context="admin" roles="ADMIN" permissions="admin.category.create"}
                                <a class="btn btn-primary action-btn" title="{intl l='Add a new variable'}" href="#">
                                    <i class="icon-plus-sign icon-white"></i>
                                </a>
                                <button class="btn btn-primary action-btn" title="{intl l='Save chages'}">{intl l='Save changes'} <i class="icon icon-white icon-ok"></i></button>
                            {/loop}

	                        </caption>
	                        <tr>
	                           <th>{intl l="Purpose"}</th>
                               <th>{intl l="Name"}</th>
                               <th>{intl l="Value"}</th>
                               <th>&nbsp;</th>
	                        </tr>
	                        {loop name="config" type="config" hidden="0" secured="*" backend_context="1"}
	                            <tr>
	                                <td>{$TITLE}</td>
	                                <td>{$NAME}</td>
	                                <td>
	                                    {if $SECURED}
	                                        {$VALUE}
	                                    {else}
	                                        <input type="text" name="value" value="{$VALUE|htmlspecialchars}" />
	                                    {/if}
	                                </td>
	                                <td>
	                                    {if ! $SECURED}
		                                    {loop type="auth" name="can_delete" context="admin" roles="ADMIN" permissions="admin.configuration.variables.delete"}
		                                       <a class="btn btn-mini config-delete" title="{intl l='Delete this configuration variable'}" href="{url path='/admin/configuration/variables/delete' id="$ID"}"><i class="icon-trash"></i></a>
		                                    {/loop}
	                                    {/if}
	                                </td>
	                            </tr>
	                        {/loop}
	                    </table>
	                </div>
                </form>
            </div>
        </div>
    </div>
</div>

{include file='includes/js.inc.html'}

<script>
    $(function() {
    	$('a.config-delete').click(function(ev) {
    		if (! confirm("{intl l='Do you really want to delete this variable ?'}")) {
    			ev.preventDefault();
    		}
    	}
    )})

</script>
{include file='includes/footer.inc.html'}